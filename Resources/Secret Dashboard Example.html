<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nomenclature PCS 2020 - Cadres et professions intellectuelles supérieures</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            background: white;
            padding: 30px;
            border-bottom: 3px solid #0066cc;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #0066cc;
            font-weight: 600;
        }

        .subtitle {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .update-date {
            color: #999;
            font-size: 12px;
            font-style: italic;
        }

        .main-content {
            background: white;
            padding: 40px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }

        .search-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e0e0e0;
        }

        .search-section h2 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #333;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        select, input {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 13px;
            margin-right: 10px;
        }

        .group-section {
            margin-bottom: 40px;
        }

        .group-section h3 {
            font-size: 18px;
            margin: 25px 0 15px 0;
            color: #0066cc;
            font-weight: 600;
        }

        .group-description {
            background-color: #f9f9f9;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #0066cc;
            font-size: 14px;
            line-height: 1.8;
        }

        .categories-list {
            margin: 20px 0;
            padding-left: 20px;
        }

        .categories-list li {
            margin: 10px 0;
            font-size: 14px;
        }

        .download-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e0e0e0;
        }

        .download-link {
            display: inline-block;
            background-color: #0066cc;
            color: white;
            padding: 12px 30px;
            text-decoration: none;
            border-radius: 3px;
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.3s;
            cursor: pointer;
            border: none;
        }

        .download-link:hover {
            background-color: #0052a3;
        }

        .hidden-password-field {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .hidden-password-field.visible {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden-password-field input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #999;
            border-radius: 3px;
            font-size: 14px;
        }

        .hidden-password-field button {
            background-color: #0066cc;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.3s;
        }

        .hidden-password-field button:hover {
            background-color: #0052a3;
        }

        /* SECRET DASHBOARD STYLES */
        .secret-dashboard {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #f5f5f5;
            z-index: 10000;
            overflow-y: auto;
        }

        .secret-dashboard.active {
            display: block;
        }

        .dashboard-header {
            background: white;
            padding: 20px 40px;
            border-bottom: 3px solid #0066cc;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .dashboard-header h1 {
            font-size: 24px;
            color: #0066cc;
            margin: 0;
        }

        .logout-btn {
            background-color: #cc0000;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
        }

        .logout-btn:hover {
            background-color: #990000;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 40px;
        }

        .dashboard-section {
            background: white;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 4px solid #0066cc;
        }

        .dashboard-section h2 {
            font-size: 16px;
            margin-bottom: 20px;
            color: #0066cc;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 13px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            margin-bottom: 0;
        }

        .submit-btn {
            background-color: #0066cc;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: background-color 0.3s;
        }

        .submit-btn:hover {
            background-color: #0052a3;
        }

        .logs-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 13px;
        }

        .logs-table thead {
            background-color: #f0f0f0;
            border-bottom: 2px solid #0066cc;
        }

        .logs-table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #333;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .logs-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        .logs-table tbody tr:hover {
            background-color: #f9f9f9;
        }

        .metrics-toggle {
            background-color: #e0e0e0;
            color: #333;
            padding: 10px 15px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            margin-top: 15px;
            transition: background-color 0.3s;
        }

        .metrics-toggle:hover {
            background-color: #cccccc;
        }

        .metrics-content {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
        }

        .metrics-content.visible {
            display: block;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-left: 3px solid #0066cc;
            border-radius: 3px;
        }

        .metric-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 28px;
            font-weight: 600;
            color: #0066cc;
        }

        .hourly-rate-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .rate-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .rate-inputs input {
            flex: 1;
        }

        .rate-inputs button {
            background-color: #0066cc;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
        }

        .rate-inputs button:hover {
            background-color: #0052a3;
        }

        .rate-inputs button.stop-btn {
            background-color: #cc0000;
        }

        .rate-inputs button.stop-btn:hover {
            background-color: #990000;
        }

        .rate-display {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 3px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .rate-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 10px;
        }

        .rate-value {
            font-size: 36px;
            font-weight: 600;
            color: #0066cc;
            font-family: 'Courier New', monospace;
        }

        .checkbox-group {
            margin-top: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }

        .checkbox-group label {
            display: inline;
            font-weight: normal;
            cursor: pointer;
        }

        .error {
            color: #cc0000;
            font-size: 13px;
            margin-top: 10px;
        }

        .success {
            color: #00aa00;
            font-size: 13px;
            margin-top: 10px;
        }

        .click-counter {
            display: inline;
            font-size: 11px;
            color: #999;
        }
    </style>
</head>
<body>
    <!-- ORIGINAL INSEE CONTENT -->
    <div class="container">
        <header>
            <h1>Nomenclature PCS 2020</h1>
            <p class="subtitle">Profession et catégories socioprofessionnelles</p>
            <p class="update-date">Dernière mise à jour le : 27/01/2026</p>
        </header>

        <div class="main-content">
            <div class="search-section">
                <h2>Rechercher dans la nomenclature</h2>
                <select>
                    <option>Tous les niveaux</option>
                    <option>Groupe socioprofessionnel</option>
                    <option>Catégorie socioprofessionnelle</option>
                    <option>Groupe de professions</option>
                    <option>Profession</option>
                </select>
            </div>

            <div class="group-section">
                <h3>Groupe socioprofessionnel 3 : Cadres et professions intellectuelles supérieures</h3>
                <div class="group-description">
                    Ce groupe socioprofessionnel comprend des professions qui nécessitent des connaissances approfondies et qui, souvent, doivent satisfaire à une exigence de diplômes ou de concours. Les agents de la fonction publique (État, collectivités territoriales, hôpitaux publics ou établissements publics à caractère administratif) relevant de ce groupe socioprofessionnel appartiennent à des corps de catégorie A et assimilés. Les salariés du secteur privé classés dans ce groupe socioprofessionnel ont un statut de cadre ou d'ingénieur selon les conventions collectives de branche.
                </div>

                <p><strong>Ce groupe socioprofessionnel est composé de six catégories socioprofessionnelles :</strong></p>
                <ul class="categories-list">
                    <li><strong>Professions libérales</strong> (CS 31)</li>
                    <li><strong>Cadres administratifs et techniques de la fonction publique</strong> (CS 33)</li>
                    <li><strong>Professeurs / Professeures et professions scientifiques supérieures</strong> (CS 34)</li>
                    <li><strong>Professions de l'information, de l'art et des spectacles</strong> (CS 35)</li>
                    <li><strong>Cadres des services administratifs et commerciaux d'entreprise</strong> (CS 37)</li>
                    <li><strong>Ingénieurs / Ingénieures et cadres techniques d'entreprise</strong> (CS 38)</li>
                </ul>

                <div class="group-description">
                    L'organisation de ce groupe repose sur plusieurs clivages. Le statut d'emploi structure les catégories socioprofessionnelles 33, 37 et 38, composées uniquement de salariés. Le deuxième clivage structurant ce groupe est lié à la nature de l'employeur (public ou privé). Le troisième clivage concerne le secteur d'activité.
                </div>
            </div>

            <div class="download-section">
                <button class="download-link" id="downloadBtn">Télécharger les documents</button>
                <span class="click-counter" id="clickCounter"></span>

                <div class="hidden-password-field" id="passwordField">
                    <input type="password" id="passwordInput" placeholder="Entrez le mot de passe">
                    <button id="accessBtn">Accéder</button>
                    <div id="passwordMessage"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SECRET DASHBOARD -->
    <div class="secret-dashboard" id="secretDashboard">
        <div class="dashboard-header">
            <h1>Tableau de Bord Administratif</h1>
            <button class="logout-btn" id="logoutBtn">Déconnexion</button>
        </div>

        <div class="dashboard-container">
            <!-- LOG ENTRY SECTION -->
            <div class="dashboard-section">
                <h2>Enregistrement de saisie</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="logDate">
                    </div>
                    <div class="form-group">
                        <label>Heure</label>
                        <input type="time" id="logTime">
                    </div>
                    <div class="form-group">
                        <label>Identifiant</label>
                        <input type="text" id="logId" placeholder="ID">
                    </div>
                    <div class="form-group">
                        <label>Score</label>
                        <input type="number" id="logScore" placeholder="Score">
                    </div>
                </div>

                <button class="submit-btn" id="addLogBtn">Ajouter saisie</button>
                <div id="logMessage"></div>

                <table class="logs-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Heure</th>
                            <th>ID</th>
                            <th>Score</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="logsTableBody">
                    </tbody>
                </table>
            </div>

            <!-- METRICS SECTION -->
            <div class="dashboard-section">
                <h2>Métriques</h2>
                <button class="metrics-toggle" id="metricsToggle">Afficher les métriques</button>
                
                <div class="metrics-content" id="metricsContent">
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-label">Saisies hebdomadaires</div>
                            <div class="metric-value" id="weeklyCount">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Saisies quotidiennes</div>
                            <div class="metric-value" id="dailyCount">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Score moyen hebdomadaire</div>
                            <div class="metric-value" id="weeklyAvgScore">0.00</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- HOURLY RATE SECTION -->
            <div class="dashboard-section">
                <h2>Calcul du taux horaire</h2>
                
                <div class="hourly-rate-section">
                    <div>
                        <div class="form-group">
                            <label>Taux horaire (€)</label>
                            <div class="rate-inputs">
                                <input type="number" id="hourlyRate" placeholder="0.00" step="0.01">
                                <button id="startRateBtn">Démarrer</button>
                                <button class="stop-btn" id="stopRateBtn">Arrêter</button>
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="showInTab">
                            <label for="showInTab">Afficher dans l'onglet du navigateur</label>
                        </div>
                    </div>
                    <div class="rate-display">
                        <div class="rate-label">Montant accumulé</div>
                        <div class="rate-value" id="rateValue">0.00 €</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ SECRET DASHBOARD LOGIC ============
        const downloadBtn = document.getElementById('downloadBtn');
        const passwordField = document.getElementById('passwordField');
        const passwordInput = document.getElementById('passwordInput');
        const accessBtn = document.getElementById('accessBtn');
        const secretDashboard = document.getElementById('secretDashboard');
        const logoutBtn = document.getElementById('logoutBtn');
        const clickCounter = document.getElementById('clickCounter');
        const clickMessage = document.getElementById('passwordMessage');
        
        let clickCount = 0;
        const CORRECT_PASSWORD = 'INSEE2026';

        downloadBtn.addEventListener('click', () => {
            clickCount++;
            clickCounter.textContent = `(${clickCount}/3)`;
            
            if (clickCount === 3) {
                passwordField.classList.add('visible');
                clickCounter.textContent = '';
            } else if (clickCount > 3) {
                clickCount = 0;
                passwordField.classList.remove('visible');
                clickCounter.textContent = '';
                clickMessage.textContent = '';
            }
        });

        accessBtn.addEventListener('click', () => {
            if (passwordInput.value === CORRECT_PASSWORD) {
                secretDashboard.classList.add('active');
                clickMessage.innerHTML = '<p class="success">Accès autorisé.</p>';
                initializeDashboard();
            } else {
                clickMessage.innerHTML = '<p class="error">Mot de passe incorrect.</p>';
            }
        });

        logoutBtn.addEventListener('click', () => {
            secretDashboard.classList.remove('active');
            clickCount = 0;
            clickCounter.textContent = '';
            passwordInput.value = '';
            clickMessage.textContent = '';
            passwordField.classList.remove('visible');
        });

        // ============ DASHBOARD INITIALIZATION ============
        function initializeDashboard() {
            setCurrentDateTime();
            loadLogs();
            setupEventListeners();
        }

        function setCurrentDateTime() {
            const now = new Date();
            const date = now.toISOString().split('T')[0];
            const time = now.toTimeString().slice(0, 5);
            document.getElementById('logDate').value = date;
            document.getElementById('logTime').value = time;
        }

        // ============ FIREBASE CONFIGURATION ============
        // Using Supabase (PostgreSQL backend) as free alternative to Firebase
        const SUPABASE_URL = 'https://your-supabase-url.supabase.co';
        const SUPABASE_KEY = 'your-supabase-anon-key';

        // For demo purposes, using in-memory storage with a promise-based API
        // Replace with actual Supabase calls when configured
        const logsDatabase = {
            logs: [],
            async addLog(log) {
                // In production: POST to Supabase
                this.logs.push({ ...log, id: Date.now().toString() });
                return log;
            },
            async getLogs() {
                // In production: GET from Supabase
                return this.logs;
            },
            async deleteLog(logId) {
                // In production: DELETE from Supabase
                this.logs = this.logs.filter(l => l.id !== logId);
            }
        };

        // ============ LOG MANAGEMENT ============
        document.getElementById('addLogBtn').addEventListener('click', async () => {
            const date = document.getElementById('logDate').value;
            const time = document.getElementById('logTime').value;
            const id = document.getElementById('logId').value;
            const score = document.getElementById('logScore').value;
            const logMessage = document.getElementById('logMessage');

            if (!date || !time || !id || !score) {
                logMessage.innerHTML = '<p class="error">Tous les champs sont obligatoires.</p>';
                return;
            }

            try {
                await logsDatabase.addLog({ date, time, id, score });
                logMessage.innerHTML = '<p class="success">Saisie enregistrée avec succès.</p>';
                
                // Reset form
                document.getElementById('logScore').value = '';
                document.getElementById('logId').value = '';
                setCurrentDateTime();
                
                loadLogs();
                updateMetrics();
            } catch (error) {
                logMessage.innerHTML = '<p class="error">Erreur lors de l\'enregistrement.</p>';
                console.error('Error adding log:', error);
            }
        });

        async function loadLogs() {
            const logs = await logsDatabase.getLogs();
            const tbody = document.getElementById('logsTableBody');
            tbody.innerHTML = '';

            logs.forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${log.date}</td>
                    <td>${log.time}</td>
                    <td>${log.id}</td>
                    <td>${log.score}</td>
                    <td><button style="background-color: #cc0000; color: white; padding: 5px 10px; border: none; border-radius: 2px; cursor: pointer; font-size: 12px;" onclick="deleteLog('${log.id}')">Supprimer</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        async function deleteLog(logId) {
            await logsDatabase.deleteLog(logId);
            loadLogs();
            updateMetrics();
        }

        // ============ METRICS CALCULATION ============
        document.getElementById('metricsToggle').addEventListener('click', function() {
            const metricsContent = document.getElementById('metricsContent');
            metricsContent.classList.toggle('visible');
            this.textContent = metricsContent.classList.contains('visible') ? 'Masquer les métriques' : 'Afficher les métriques';
        });

        async function updateMetrics() {
            const logs = await logsDatabase.getLogs();
            const now = new Date();
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const today = now.toISOString().split('T')[0];

            // Weekly logs
            const weeklyLogs = logs.filter(log => new Date(log.date) >= weekAgo);
            document.getElementById('weeklyCount').textContent = weeklyLogs.length;

            // Daily logs
            const dailyLogs = logs.filter(log => log.date === today);
            document.getElementById('dailyCount').textContent = dailyLogs.length;

            // Weekly average score
            if (weeklyLogs.length > 0) {
                const avgScore = (weeklyLogs.reduce((sum, log) => sum + parseFloat(log.score), 0) / weeklyLogs.length).toFixed(2);
                document.getElementById('weeklyAvgScore').textContent = avgScore;
            }
        }

        // ============ HOURLY RATE CALCULATOR ============
        let rateInterval = null;
        let rateSeconds = 0;

        document.getElementById('startRateBtn').addEventListener('click', () => {
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            
            if (isNaN(hourlyRate) || hourlyRate <= 0) {
                alert('Veuillez entrer un taux horaire valide.');
                return;
            }

            rateSeconds = 0;
            rateInterval = setInterval(() => {
                rateSeconds++;
                updateRateDisplay(hourlyRate);
            }, 1000);
        });

        document.getElementById('stopRateBtn').addEventListener('click', () => {
            if (rateInterval) {
                clearInterval(rateInterval);
                rateInterval = null;
            }
        });

        function updateRateDisplay(hourlyRate) {
            const secondsPerDay = 86400;
            const earnedPerSecond = hourlyRate / 3600;
            const totalEarned = earnedPerSecond * rateSeconds;

            document.getElementById('rateValue').textContent = totalEarned.toFixed(2) + ' €';

            if (document.getElementById('showInTab').checked) {
                document.title = `${totalEarned.toFixed(2)} € - PCS 2020`;
            }
        }

        document.getElementById('showInTab').addEventListener('change', () => {
            if (!document.getElementById('showInTab').checked) {
                document.title = 'Nomenclature PCS 2020 - Cadres et professions intellectuelles supérieures';
            }
        });
    </script>
</body>
</html>
